{% load static %}
<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Gest√£o de Frotas</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
</head>

<body>
    <div class="dashboard-container">
        <section class="nav-cards">
            <a href="{% url 'vehicle-list' %}" class="nav-card color-blue">
                <div class="nav-card-icon">üöó</div>
                <h3>Gerenciamento de Ve√≠culos</h3>
                <p>Gerencie sua frota de ve√≠culos</p>
                <span class="nav-card-arrow">‚Üí</span>
            </a>
            <a href="{% url 'driver-list' %}" class="nav-card color-green">
                <div class="nav-card-icon">üë§</div>
                <h3>Gerenciamento de Motoristas</h3>
                <p>Gerencie os perfis dos motoristas</p>
                <span class="nav-card-arrow">‚Üí</span>
            </a>
            <a href="{% url 'route-list' %}" class="nav-card color-purple">
                <div class="nav-card-icon">üó∫Ô∏è</div>
                <h3>Planejamento de Rotas</h3>
                <p>Otimize as rotas de entrega</p>
                <span class="nav-card-arrow">‚Üí</span>
            </a>
            <a href="{% url 'maintenance-list' %}" class="nav-card color-orange">
                <div class="nav-card-icon">üõ†Ô∏è</div>
                <h3>Manuten√ß√£o</h3>
                <p>Agende e acompanhe manuten√ß√µes</p>
                <span class="nav-card-arrow">‚Üí</span>
            </a>
        </section>

        <main class="dashboard-grid">
            <div class="grid-card overview-card">
                <div class="card-header">
                    <h4>Resumo de Ve√≠culos</h4>
                    <a href="{% url 'vehicle-list' %}">Ver Todos ‚Üí</a>
                </div>
                <div class="overview-stats">
                    <div class="stat-item color-light-blue">
                        <span class="stat-value">{{ vehicle_overview.total }}</span>
                        <span class="stat-label">Total de Ve√≠culos</span>
                    </div>
                    <div class="stat-item color-light-green">
                        <span class="stat-value">{{ vehicle_overview.available }}</span>
                        <span class="stat-label">Dispon√≠veis</span>
                    </div>
                </div>
                <ul class="overview-legend">
                    <li><span class="legend-dot color-blue"></span>Em Uso <span class="legend-value">{{ vehicle_overview.in_use }}</span></li>
                    <li><span class="legend-dot color-orange"></span>Manuten√ß√£o <span class="legend-value">{{ vehicle_overview.maintenance }}</span></li>
                    <li><span class="legend-dot color-red"></span>Indispon√≠vel <span class="legend-value">{{ vehicle_overview.unavailable }}</span></li>
                </ul>
            </div>

            <div class="grid-card overview-card">
                <div class="card-header">
                    <h4>Resumo de Motoristas</h4>
                    <a href="{% url 'driver-list' %}">Ver Todos ‚Üí</a>
                </div>
                <div class="overview-stats">
                    <div class="stat-item color-light-blue">
                        <span class="stat-value">{{ driver_overview.total }}</span>
                        <span class="stat-label">Total de Motoristas</span>
                    </div>
                    <div class="stat-item color-light-green">
                        <span class="stat-value">{{ driver_overview.active }}</span>
                        <span class="stat-label">Ativos</span>
                    </div>
                </div>
                 <ul class="overview-legend">
                    <li><span class="legend-dot color-green"></span>Ativo <span class="legend-value">{{ driver_overview.active }}</span></li>
                    <li><span class="legend-dot color-red"></span>Inativo <span class="legend-value">{{ driver_overview.inactive }}</span></li>
                </ul>
            </div>

            <div class="grid-card activity-card">
                <div class="card-header">
                    <h4>Atividade Recente</h4>
                    <a href="#">Ver Tudo ‚Üí</a>
                </div>
                <ul class="activity-list">
                    {% for route in recent_routes %}
                    <li>
                        <div class="activity-icon color-blue">üöó</div>
                        <p>Rota do ve√≠culo <strong>{{ route.vehicle.plate }}</strong> finalizada.</p>
                    </li>
                    {% endfor %}
                    {% for maint in recent_maintenances %}
                    <li>
                        <div class="activity-icon color-green">üõ†Ô∏è</div>
                         <p>Manuten√ß√£o <strong>{{ maint.service_type }}</strong> conclu√≠da para <strong>{{ maint.vehicle.plate }}</strong>.</p>
                    </li>
                    {% endfor %}
                </ul>
            </div>

            <div class="grid-card maintenance-card">
                <div class="card-header">
                    <h4>Pr√≥ximas Manuten√ß√µes</h4>
                    <a href="{% url 'maintenance-list' %}">Agendar +</a>
                </div>
                <ul class="maintenance-list">
                    {% for maint in upcoming_maintenances %}
                    <li>
                        <div class="maintenance-icon">üõ†Ô∏è</div>
                        <div class="maintenance-info">
                            <p><strong>{{ maint.vehicle.plate }}</strong> - {{ maint.service_type }}</p>
                            <small>{{ maint.start_date|date:"d/m/Y" }}</small>
                        </div>
                    </li>
                    {% empty %}
                    <p style="text-align: center; color: var(--text-secondary-color);">Nenhuma manuten√ß√£o agendada.</p>
                    {% endfor %}
                </ul>
            </div>
        </main>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://npmcdn.com/flatpickr/dist/l10n/pt.js"></script>
    <script src="{% static 'js/dashboard.js' %}"></script>
</body>

</html>